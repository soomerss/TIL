# 06-01 - 인덱스
## 개념
- 인덱스란 영어 사전 처럼 잘 정렬되어 찾기 쉬운상태이거나 책 뒤에 찾아보기 처럼 색인을 다는 것을 말한다.
- DB에서 전자는 클러스터형 인덱스, 후자는 보조 인덱스라고 한다.
- 특정'열'을 기준으로 잘 찾을 수 있도록 테이블을 구성하는 것이다.
- 특정 열 2개를 묶어서 할 수도 있지만 다루지 아니한다.

## 사용시 주의점
- 인덱스는 그 자체로 저장공간을 필요로 한다. 따라서 필요 없는 인덱스를 만들게 되면 불필요한 성능저하를 불러올 수 있다.
- 또한 인덱스는 SELECT문에서 활용한다. 따라서 삽입,삭제가 빈번한반면 조회는 1년에 한번정도만 하는 경우 그 성능이 현저히 저하될 수 있다.

## 클러스터형 인덱스와 보조 인덱스 - 자동생성
- 먼저 클러스터형 인덱스는 PRIMARY KEY를 설정하게 되면 자동으로 인덱스가 설정된다. 즉, PRIMARY KEY 해당 열이 인덱스_열이 된다.
- 보조 인덱스 중에서 UNIQUE KEY를 설정한 열이 있을 경우에 해당열을 기준으로 인덱스가 자동 설정된다. 이때 고유키를 설정한 열을 기준으로 테이블은 정렬되지 않는다. 다만, 색인이 달리게 될뿐이다.
- 즉, 클러스터형 인덱스는 그 열을 기준으로 정렬되지만, 보조 인덱스는 정렬되지 않는다.
- 또한 고유 인덱스는 값이 중복되지 않는 인덱스를 말하는데, PRIMARY KEY, UNIQUE KEY를 설정한 열을 일컫는다.

# 06-02 - 인덱스의 내부작동
## 클러스터링 인덱스
* INDEX는 B-TREE(Balanced Tree)를 기준으로 정렬되어 있다.
* 균형 트리구조에서 데이터가 저장되는 공간은 노드이며, MY_SQL에서 페이지라고한다.
* 이때 페이지는 저장되는 데이터가 아무리 적더라도 16Kbyte(16384byte)의 값을 차지한다.
* 균형트리는 1~10까지 정렬한다고 할때 각 노드 별로 균형된 데이터를 가지게 되고, 어떤 데이터가 입력하거나 삭제될때마다 그 노드의 수정이 빈번하게되면 시간이 많이 걸리게 되어 성능저하가 발생한다.
* 즉, 페이지 분할이 빈번하면 MYSQL이 느려지게된다.

## 보조인덱스
* 보조인덱스는 인덱스 페이지와 데이터 페이지가 있으며, 인덱스 페이지에서 페이지번호+#위치 등으로 기록하여 데이터 페이지에서 찾아나간다.
* 따라서 클러스터링 인덱스가 성능이 조금 더 좋다.

## 그 외
* 인덱스에 대한 상세한 원리는 조금 더 공부가 필요하다.

# 06-03 - 인덱스의 사용
## 생성 및 제거
- 생성(더 복잡한것은 다루지 않는다.)
```
CREATE [UNIQUE] TABLE index명 -- 네이밍은 다음과 같다. idx_table명_Field명
ON TABLE(FIELD) [ASC|DESC] -- ASC가 기본이며, DESC는 잘 사용하지 않는다.
```
- 제거
```
DROP INDEX index명 ON TABLE명;
```

## 인덱스 설정 확인 명령어 등
- 인덱스 생성 후 반영
```
ANALYZE table명
```
- 인덱스 보기
```
SHOW INDEX FROM TABLE명
```
- 인덱스의 크기 등 보기
```
SHOW TABLE STATUS LIKE '테이블명'
```

## 기본키로 자동설정 된 인덱스 해제방법
- 기본키로 설정된 인덱스는 위와 같은 방법으로 할 수 없다. 또한 외래키가 연결되어 있을 경우 해당 연결을 끊고 기본키를 삭제해야 한다.
- 기본키 삭제하여 인덱스 해제하기
```
ALTER TABLE TABLE명
DROP PRIMARY KEY;
```
- Foreign KEY 확인 및 제거 
```
select table_name, constraint_name
FROM information_schema.referential_constraints
where constraint_schema = '테이블 명';

ALTER TABLE table명
DROP FOREIGN KEY constraint_이름;
```